<html>
<head>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
</head>
<body>
	<script type="text/javascript">
		$(window).load(function() {
		
			var location = document.location.href;
			var method = location.substring(location.indexOf('?')+1);
			var isIE = navigator.appName.indexOf('Microsoft')  === 0;
		
			var cssFile = '//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css';
			var jsFile = '//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js';

			if (method == 'iframe') {
			
				// Chrome - Works - http://www.webpagetest.org/result/131225_95_CD5/
				// FF -  - http://www.webpagetest.org/result/131205_DD_D31/
			
				// Chrome
				var iframe = document.createElement('iframe');
				iframe.setAttribute("width", "0");
				iframe.setAttribute("height", "0");
				iframe.setAttribute("frameborder", "0");
				iframe.setAttribute("name", "preload");
				iframe.id = "preload";
				iframe.src = "about:blank";
				document.body.appendChild(iframe);
		 
				// gymnastics to get reference to the iframe document
				iframe = document.all ? document.all.preload.contentWindow : window.frames.preload;
				var doc = iframe.document;
				doc.open();
				doc.writeln("<html><body></body></html>");
				doc.close();
				
				var iFrameAddFile = function(filename) {
					var css = doc.createElement('link');
					css.type = 'text/css';
					css.rel = 'stylesheet';
					css.href = filename;
					doc.body.appendChild(css);
				}
				
				iFrameAddFile('https:' + cssFile);
				iFrameAddFile('http:' + cssFile);
				
				iFrameAddFile('http:' + jsFile);
				iFrameAddFile('https:' + jsFile);
			}
			else if (method == 'image') {
			
				// Chrome - V - http://www.webpagetest.org/result/131205_1Z_E4W/
				// FF - doesn't cache css files - http://www.webpagetest.org/result/131205_K7_E64/
				// IE8 - doesn't cache anything! - 
				// IE9 - doesn't cache anything! - http://www.webpagetest.org/result/131205_XR_E7H/
				// IE10 - 
			
				// This works on FF & Chrome - Simple and elegant :)
				new Image().src = 'https:' + cssFile;
				new Image().src = 'http:' + cssFile;
				
				new Image().src = 'http:' + jsFile;
				new Image().src = 'https:' + jsFile;
				
			}
			else if (method == 'object') {
				
				// Chrome - V - http://www.webpagetest.org/result/131205_6G_EBH/
				// FF - V - http://www.webpagetest.org/result/131205_H4_EAH/
				// IE8 - doesn't cache https file - http://www.webpagetest.org/result/131205_C8_EEA/
				// IE9 - doesn't cache any file - http://www.webpagetest.org/result/131205_3Y_EF9/
				// IE10 - 
				
				var createObjectTag = function(filename) {
					var o = document.createElement('object');
					o.data = filename;
					
					// IE stuff, otherwise 0x0 is OK
					if (isIE) {
						o.width = 1;
						o.height = 1;
						o.style.visibility = "hidden";
						o.type = "text/plain";
					}
					else {
						o.width  = 0;
						o.height = 0;
					}
					
					document.body.appendChild(o);
				}
				
				createObjectTag('http:' + cssFile);
				createObjectTag('https:' + cssFile);
				
				createObjectTag('http:' + jsFile);
				createObjectTag('https:' + jsFile);
				
			}
			else if (method == 'ajax') {
			
				var ajaxRequest = function(filename) {
					var xhr = new XMLHttpRequest();
					xhr.open('GET', filename);
					xhr.send('');
				}
				ajaxRequest('http:' + cssFile);
				ajaxRequest('https:' + cssFile);
			
				ajaxRequest('http:' + jsFile);
				ajaxRequest('https:' + jsFile);
			}
			else if (method == 'prefetch') {
			
				var prefetchTag = function(filename) {
					var link = document.createElement('link');
					link.href = preload[i];
					link.rel = "prefetch";
					document.getElementsByTagName('head')[0].appendChild(link);
				}
				prefetchTag('http:' + cssFile);
				prefetchTag('https:' + cssFile);
				
				prefetchTag('http:' + jsFile);
				prefetchTag('https:' + jsFile);
			}
			else if (method == 'invalid-script') {
			
				// creates a script tag with an invalid type, like 'script/cache'
				// this technique is used by LabJS
				var invalidScript = function(filename) {
					var s = document.createElement('script');
					s.src = filename;
					s.type = 'script/cache';
					document.getElementsByTagName('head')[0].appendChild(s);
				}
				invalidScript('http:' + cssFile);
				invalidScript('https:' + cssFile);
				
				invalidScript('http:' + jsFile);
				invalidScript('https:' + jsFile);
			
			}
		});
	</script>
</body>
</html>